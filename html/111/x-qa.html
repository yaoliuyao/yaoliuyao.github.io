<!DOCTYPE html>
<html lang="en">
<head>
<!-- 2021-04-14 -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>答疑 (Q &amp; A)</title>
<meta name="generator" content="Org mode">
<meta name="author" content="悟饭">
<link rel='stylesheet' href='/html/asset/common.css?3344' />
<link rel='stylesheet' href='/yaoliuyao/html/asset/common.css?3344' />
<script src='https://cdn.bootcss.com/jquery/2.1.3/jquery.min.js'></script>
<script src='https://cdn.bootcss.com/bootstrap/3.3.4/js/bootstrap.min.js'></script>
<script src='/html/asset/common.js'></script>
<script src='/yaoliuyao/html/asset/common.js'></script>

<style>
 /* From: https://endlessparentheses.com/public/css/endless.css */
 .special-kbd {
   color: #333;
   background-color: #f7f7f7;
   border: 1px solid #ccc;
   border-radius: 6px;
   box-shadow: 0 1px 0 rgba(0,0,0,0.2),0 0 0 2px #fff inset;
   display: inline-block;
   font-family: 'Droid Sans Mono', monospace;
   font-size: 80%;
   font-weight: normal;
   line-height: inherit;
   margin: 2px .1em;
   padding: .04em .4em;
   text-shadow: 0 1px 0 #fff;
   word-spacing: -3px;
 }
</style>
</head>
<body>
<div id="content">
<header>
<h1 class="title">答疑 (Q &amp; A)</h1>
</header><nav id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgf31ce4a">1. 资源的释放</a></li>
</ul>
</div>
</nav>



<section id="outline-container-orgf31ce4a" class="outline-2">
<h2 id="orgf31ce4a"><span class="section-number-2">1</span> 资源的释放</h2>
<div class="outline-text-2" id="text-1">
<ul class="org-ul">
<li>资源，是指需要在操作系统中打开，用完之后，需要手动释放的对象</li>
<li>为什么需要手动释放呢？因为 .NET 平台不是万能的。虽然 .NET 平台有垃圾回收器，你不再需要的
对象，它会自动帮你清理掉，但是有些东西它是无法确定你到底还需不需要，所以无法帮助你自动处理。
你也只能手动释放或关闭</li>
<li>对于一些资源，必须要手动释放或关闭</li>
</ul>

<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #b22222;">// </span><span style="color: #b22222;">&#21019;&#24314;&#30340;&#20219;&#20309;&#23545;&#35937;&#65292;&#37117;&#26159;&#21487;&#20197;&#34987;&#22403;&#22334;&#22238;&#25910;&#22120; (GC) &#33258;&#21160;&#37322;&#25918;</span>
<span style="color: #b22222;">// </span><span style="color: #b22222;">&#22240;&#27492;&#65292;&#25105;&#20204;&#21482;&#38656;&#35201; new &#28982;&#21518;&#20351;&#29992;&#23601;&#21487;&#20197;&#20102;&#65292;&#20854;&#20182;&#30340;&#20869;&#23384;&#31649;&#29702;&#26080;&#38656;&#20320;&#20851;&#24515;</span>
<span style="color: #228b22;">var</span> <span style="color: #a0522d;">a</span> = <span style="color: #a020f0;">new</span> <span style="color: #228b22;">Book</span><span style="color: #707183;">()</span>;

<span style="color: #b22222;">// </span><span style="color: #b22222;">&#20687;&#25991;&#20214;&#36825;&#26679;&#30340;&#36164;&#28304;&#65292;&#25171;&#24320;&#20043;&#21518;&#65292;&#24517;&#39035;&#35201;&#25163;&#21160;&#37322;&#25918;</span>
<span style="color: #228b22;">var</span> <span style="color: #a0522d;">fs</span> = File.<span style="color: #0000ff;">OpenRead</span><span style="color: #707183;">(</span>fileName<span style="color: #707183;">)</span>;
Console.<span style="color: #0000ff;">WriteLine</span><span style="color: #707183;">(</span>5/0<span style="color: #707183;">)</span>; <span style="color: #b22222;">// </span><span style="color: #b22222;">&#20195;&#34920;&#20351;&#29992; (2)</span>
fs.<span style="color: #0000ff;">Close</span><span style="color: #707183;">()</span>;             <span style="color: #b22222;">// </span><span style="color: #b22222;">&#25163;&#21160;&#20851;&#38381;/&#37322;&#25918;</span>

<span style="color: #b22222;">// </span><span style="color: #b22222;">&#19978;&#36848;&#30340;&#20195;&#30721;&#26159;&#26377;&#38382;&#39064;&#30340;&#65292;&#22240;&#20026;&#65292;&#22914;&#26524; (2) &#20986;&#29616;&#38169;&#35823;&#30340;&#35805;&#65292;&#37027;&#20040;&#37322;&#25918;&#30340;&#35821;&#21477;&#23601;&#26080;&#27861;&#25191;&#34892;</span>
<span style="color: #b22222;">// </span><span style="color: #b22222;">&#20026;&#20102;&#35299;&#20915;&#36825;&#20010;&#38382;&#39064;&#65292;&#21487;&#20197;&#20351;&#29992; finally &#35821;&#27861;&#65292;&#23545;&#25972;&#20010;&#36164;&#28304;&#37322;&#25918;&#30340;&#20195;&#30721;&#36827;&#34892;&#37325;&#26500;</span>
<span style="color: #228b22;">FileStream</span> <span style="color: #a0522d;">fs</span> = <span style="color: #008b8b;">null</span>;
<span style="color: #a020f0;">try</span>
<span style="color: #707183;">{</span>
    fs = File.<span style="color: #0000ff;">OpenRead</span><span style="color: #7388d6;">(</span>fileName<span style="color: #7388d6;">)</span>;
    Console.<span style="color: #0000ff;">WriteLine</span><span style="color: #7388d6;">(</span>fs<span style="color: #7388d6;">)</span>;
    Console.<span style="color: #0000ff;">WriteLine</span><span style="color: #7388d6;">(</span>5/0<span style="color: #7388d6;">)</span>;
    Console.<span style="color: #0000ff;">WriteLine</span><span style="color: #7388d6;">(</span><span style="color: #8b2252;">"&#20854;&#20182;&#20320;&#25152;&#38656;&#35201;&#20570;&#30340;&#20107;&#24773;"</span><span style="color: #7388d6;">)</span>;
<span style="color: #707183;">}</span>
<span style="color: #a020f0;">finally</span>
<span style="color: #707183;">{</span>
    <span style="color: #a020f0;">if</span> <span style="color: #7388d6;">(</span>fs != <span style="color: #008b8b;">null</span><span style="color: #7388d6;">)</span>
    <span style="color: #7388d6;">{</span>
        <span style="color: #a020f0;">try</span>
        <span style="color: #909183;">{</span>
            fs.<span style="color: #0000ff;">Close</span><span style="color: #709870;">()</span>;
        <span style="color: #909183;">}</span>
        <span style="color: #a020f0;">catch</span>
        <span style="color: #909183;">{</span>
            Console.<span style="color: #0000ff;">WriteLine</span><span style="color: #709870;">(</span><span style="color: #8b2252;">"&#20851;&#38381;&#22833;&#36133;"</span><span style="color: #709870;">)</span>;
        <span style="color: #909183;">}</span>
    <span style="color: #7388d6;">}</span>
<span style="color: #707183;">}</span>

<span style="color: #b22222;">// </span><span style="color: #b22222;">&#21487;&#20197;&#20351;&#29992; using &#23545;&#19978;&#36848;&#20195;&#30721;&#36827;&#34892;&#31616;&#21270;</span>
<span style="color: #b22222;">// </span><span style="color: #b22222;">&#24517;&#39035;&#35753; FileStream &#37324;&#38754;&#23454;&#29616;&#19968;&#20010;&#21483; Close &#30340;&#26041;&#27861;</span>
<span style="color: #b22222;">// </span><span style="color: #b22222;">&#20026;&#20102;&#20445;&#35777;&#20320;&#24517;&#39035;&#23454;&#29616;&#19968;&#20010; Close &#26041;&#27861;&#65292;&#20320;&#24517;&#39035;&#35201;&#23454;&#29616; IDisposable &#25509;&#21475;</span>
<span style="color: #a020f0;">using</span> <span style="color: #707183;">(</span><span style="color: #228b22;">FileStream</span> <span style="color: #a0522d;">fs</span> = File.<span style="color: #0000ff;">OpenRead</span><span style="color: #7388d6;">(</span>fileName<span style="color: #7388d6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">{</span>
    Console.<span style="color: #0000ff;">WriteLine</span><span style="color: #7388d6;">(</span>fs<span style="color: #7388d6;">)</span>;
    Console.<span style="color: #0000ff;">WriteLine</span><span style="color: #7388d6;">(</span>5/0<span style="color: #7388d6;">)</span>;
    Console.<span style="color: #0000ff;">WriteLine</span><span style="color: #7388d6;">(</span><span style="color: #8b2252;">"&#20854;&#20182;&#20320;&#25152;&#38656;&#35201;&#20570;&#30340;&#20107;&#24773;"</span><span style="color: #7388d6;">)</span>;
<span style="color: #707183;">}</span>

<span style="color: #b22222;">// </span><span style="color: #b22222;">&#26368;&#26032;&#30340; C# &#29256;&#26412;&#21448;&#32473;&#20102;&#26032;&#30340;&#31958;</span>
<span style="color: #a020f0;">using</span> <span style="color: #a0522d;">FileStream</span> f<span style="color: #a0522d;">s</span> = <span style="color: #a0522d;">File</span>.<span style="color: #a0522d;">OpenRead</span><span style="color: #707183;">(</span><span style="color: #a0522d;">fileName</span><span style="color: #707183;">)</span>; <span style="color: #b22222;">// </span><span style="color: #b22222;">fs &#22312;&#21518;&#38754;&#30896;&#21040; } &#21518;&#65292;&#20250;&#33258;&#21160;&#37322;&#25918;</span>
Console.<span style="color: #0000ff;">WriteLine</span><span style="color: #707183;">(</span>fs<span style="color: #707183;">)</span>;
Console.<span style="color: #0000ff;">WriteLine</span><span style="color: #707183;">(</span>5/0<span style="color: #707183;">)</span>;
Console.<span style="color: #0000ff;">WriteLine</span><span style="color: #707183;">(</span><span style="color: #8b2252;">"&#20854;&#20182;&#20320;&#25152;&#38656;&#35201;&#20570;&#30340;&#20107;&#24773;"</span><span style="color: #707183;">)</span>;
</pre>
</div>
</div>
</section>
</div>
<div id="postamble" class="status">
<p class="author">Author: 悟饭</p>
<p class="date">Created: 2021-04-14</p>
<p class="validation">Go ahead, never stop.</p>
</div>
</body>
</html>
