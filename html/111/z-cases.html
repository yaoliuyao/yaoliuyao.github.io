<!DOCTYPE html>
<html lang="en">
<head>
<!-- 2021-05-31 -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>一万行代码</title>
<meta name="generator" content="Org mode">
<meta name="author" content="悟饭">
<link rel='stylesheet' href='/html/asset/common.css?3344' />
<link rel='stylesheet' href='/yaoliuyao/html/asset/common.css?3344' />
<script src='https://cdn.bootcss.com/jquery/2.1.3/jquery.min.js'></script>
<script src='https://cdn.bootcss.com/bootstrap/3.3.4/js/bootstrap.min.js'></script>
<script src='/html/asset/common.js'></script>
<script src='/yaoliuyao/html/asset/common.js'></script>

<style>
 /* From: https://endlessparentheses.com/public/css/endless.css */
 .special-kbd {
   color: #333;
   background-color: #f7f7f7;
   border: 1px solid #ccc;
   border-radius: 6px;
   box-shadow: 0 1px 0 rgba(0,0,0,0.2),0 0 0 2px #fff inset;
   display: inline-block;
   font-family: 'Droid Sans Mono', monospace;
   font-size: 80%;
   font-weight: normal;
   line-height: inherit;
   margin: 2px .1em;
   padding: .04em .4em;
   text-shadow: 0 1px 0 #fff;
   word-spacing: -3px;
 }
</style>
</head>
<body>
<div id="content">
<header>
<h1 class="title">一万行代码</h1>
</header><nav id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org2d37ea0">1. 游戏祖玛</a>
<ul>
<li><a href="#org9d20f6b">1.1. 游戏描述</a></li>
<li><a href="#org21f02ba">1.2. 预备知识</a>
<ul>
<li><a href="#orgd753dd5">1.2.1. 如何避免 ReadLine 阻塞</a></li>
<li><a href="#orgbd68366">1.2.2. Console 的定点输出</a></li>
<li><a href="#org6743c93">1.2.3. 随机字符串的生成逻辑</a></li>
<li><a href="#org934289b">1.2.4. 消除字符串的基本逻辑</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</nav>


<section id="outline-container-org2d37ea0" class="outline-2">
<h2 id="org2d37ea0"><span class="section-number-2">1.</span> 游戏祖玛</h2>
<div class="outline-text-2" id="text-1">
</div>
<div id="outline-container-org9d20f6b" class="outline-3">
<h3 id="org9d20f6b"><span class="section-number-3">1.1.</span> 游戏描述</h3>
<div class="outline-text-3" id="text-1-1">
<p>
实现游戏祖玛!
</p>
<ul class="org-ul">
<li>核心是一个 <b>字符串</b> 代码的所谓祖玛</li>
<li>若干方法，都围绕这个字符串:</li>
<li>初始化这个随机字符串的方法</li>
<li>绘制这个字符串到屏幕上的方法</li>
<li>不停让字符串增加长度的任务方法</li>
<li>通过 ReadLine 交互将某个字符插入到这个字符串的方法</li>
<li>每次有字符插入到字符串之后，进行消除相同字符的方法</li>
<li>每次有字符插入到字符串之后，根据长度判断游戏是否结束的方法</li>
</ul>

<p>
除了这个叫祖玛的字符串，类中还可以具备其他状态:
</p>
<ul class="org-ul">
<li>比如定义祖玛字符串所需要用到的所有字符</li>
<li>比如定义祖玛自增长的时间间隔</li>
<li>比如记录游戏开始的时间</li>
<li>比如用户名字、分数等个性化数据</li>
</ul>

<p>
因此，我们需要的，至少是两个类:
</p>
<ul class="org-ul">
<li>祖玛类型，封装了祖玛字符串和其行为</li>
<li>游戏主循环，用来调用祖玛并将其行为有效展示出来</li>
</ul>
</div>
</div>

<div id="outline-container-org21f02ba" class="outline-3">
<h3 id="org21f02ba"><span class="section-number-3">1.2.</span> 预备知识</h3>
<div class="outline-text-3" id="text-1-2">
</div>
<div id="outline-container-orgd753dd5" class="outline-4">
<h4 id="orgd753dd5"><span class="section-number-4">1.2.1.</span> 如何避免 ReadLine 阻塞</h4>
<div class="outline-text-4" id="text-1-2-1">
<p>
不完美，但是足够简单的方法:
</p>
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #a020f0;">while</span> <span style="color: #707183;">(</span><span style="color: #008b8b;">true</span><span style="color: #707183;">)</span>
<span style="color: #707183;">{</span>
    Console.<span style="color: #0000ff;">WriteLine</span><span style="color: #7388d6;">(</span><span style="color: #8b2252;">"..."</span><span style="color: #7388d6;">)</span>;
    Thread.<span style="color: #0000ff;">Sleep</span><span style="color: #7388d6;">(</span>500<span style="color: #7388d6;">)</span>;
    <span style="color: #a020f0;">if</span> <span style="color: #7388d6;">(</span>Console.KeyAvailable<span style="color: #7388d6;">)</span> <span style="color: #b22222;">// </span><span style="color: #b22222;">&#29992;&#25143;&#26377;&#27809;&#26377;&#25970;&#38190;&#30424;</span>
    <span style="color: #7388d6;">{</span>
        <span style="color: #228b22;">var</span> <span style="color: #a0522d;">a</span> = Console.<span style="color: #0000ff;">ReadLine</span><span style="color: #909183;">()</span>; <span style="color: #b22222;">// </span><span style="color: #b22222;">&#31561;&#24453;&#29992;&#25143;&#36755;&#20837;&#28857;&#21861;</span>
        Console.<span style="color: #0000ff;">WriteLine</span><span style="color: #909183;">(</span><span style="color: #8b2252;">"&#24744;&#30340;&#36755;&#20837;&#26159;: "</span> + a<span style="color: #909183;">)</span>;
    <span style="color: #7388d6;">}</span>
<span style="color: #707183;">}</span>
</pre>
</div>

<p>
使用多线程(多任务) 的方式进行实现:
</p>
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #b22222;">// </span><span style="color: #b22222;">System.Threading.Tasks;</span>

<span style="color: #228b22;">string</span> <span style="color: #a0522d;">a</span> = <span style="color: #008b8b;">null</span>;

Task.<span style="color: #0000ff;">Run</span><span style="color: #707183;">(</span><span style="color: #7388d6;">()</span> =&gt;
<span style="color: #7388d6;">{</span>
    <span style="color: #a020f0;">while</span> <span style="color: #909183;">(</span><span style="color: #008b8b;">true</span><span style="color: #909183;">)</span>
    <span style="color: #909183;">{</span>
        a = Console.<span style="color: #0000ff;">ReadLine</span><span style="color: #709870;">()</span>; <span style="color: #b22222;">// </span><span style="color: #b22222;">&#31561;&#24453;&#29992;&#25143;&#36755;&#20837;&#28857;&#21861;</span>
        Console.<span style="color: #0000ff;">WriteLine</span><span style="color: #709870;">(</span><span style="color: #8b2252;">"&#24744;&#30340;&#36755;&#20837;&#26159;: "</span> + a<span style="color: #709870;">)</span>;
    <span style="color: #909183;">}</span>
<span style="color: #7388d6;">}</span><span style="color: #707183;">)</span>;

Task.<span style="color: #0000ff;">Run</span><span style="color: #707183;">(</span><span style="color: #7388d6;">()</span> =&gt;
<span style="color: #7388d6;">{</span>
    Thread.<span style="color: #0000ff;">Sleep</span><span style="color: #909183;">(</span>5000<span style="color: #909183;">)</span>;
    Console.<span style="color: #0000ff;">WriteLine</span><span style="color: #909183;">(</span><span style="color: #8b2252;">",,,"</span><span style="color: #909183;">)</span>;
<span style="color: #7388d6;">}</span><span style="color: #707183;">)</span>;

<span style="color: #b22222;">// </span><span style="color: #b22222;">&#20027;&#32447;&#31243;</span>
<span style="color: #a020f0;">while</span> <span style="color: #707183;">(</span><span style="color: #008b8b;">true</span><span style="color: #707183;">)</span>
<span style="color: #707183;">{</span>
    Console.<span style="color: #0000ff;">WriteLine</span><span style="color: #7388d6;">(</span><span style="color: #8b2252;">"..."</span><span style="color: #7388d6;">)</span>;
    Thread.<span style="color: #0000ff;">Sleep</span><span style="color: #7388d6;">(</span>500<span style="color: #7388d6;">)</span>;
<span style="color: #707183;">}</span>

</pre>
</div>
</div>
</div>

<div id="outline-container-orgbd68366" class="outline-4">
<h4 id="orgbd68366"><span class="section-number-4">1.2.2.</span> Console 的定点输出</h4>
<div class="outline-text-4" id="text-1-2-2">
<div class="org-src-container">
<pre class="src src-csharp">Console.<span style="color: #0000ff;">Clear</span><span style="color: #707183;">()</span>;

<span style="color: #a020f0;">for</span> <span style="color: #707183;">(</span><span style="color: #228b22;">int</span> <span style="color: #a0522d;">i</span> = 0; i &lt; 15; i++<span style="color: #707183;">)</span>
<span style="color: #707183;">{</span>
    Console.ForegroundColor = ConsoleColor.DarkGray;
    Console.<span style="color: #0000ff;">SetCursorPosition</span><span style="color: #7388d6;">(</span>0, i<span style="color: #7388d6;">)</span>;
    Console.<span style="color: #0000ff;">Write</span><span style="color: #7388d6;">(</span><span style="color: #8b2252;">"{0,3}"</span>, i + 1<span style="color: #7388d6;">)</span>;
    Console.ForegroundColor = ConsoleColor.Black;
<span style="color: #707183;">}</span>

Console.<span style="color: #0000ff;">SetCursorPosition</span><span style="color: #707183;">(</span>10, 5<span style="color: #707183;">)</span>;
Console.<span style="color: #0000ff;">WriteLine</span><span style="color: #707183;">(</span><span style="color: #8b2252;">"hello, world"</span><span style="color: #707183;">)</span>;

Console.<span style="color: #0000ff;">SetCursorPosition</span><span style="color: #707183;">(</span>4, 10<span style="color: #707183;">)</span>;
Console.<span style="color: #0000ff;">Write</span><span style="color: #707183;">(</span><span style="color: #8b2252;">"&#35831;&#36755;&#20837;&#24744;&#30340;&#30041;&#35328;: "</span><span style="color: #707183;">)</span>;
Console.<span style="color: #0000ff;">ReadLine</span><span style="color: #707183;">()</span>;
</pre>
</div>
</div>
</div>

<div id="outline-container-org6743c93" class="outline-4">
<h4 id="org6743c93"><span class="section-number-4">1.2.3.</span> 随机字符串的生成逻辑</h4>
<div class="outline-text-4" id="text-1-2-3">
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #228b22;">var</span> <span style="color: #a0522d;">r</span> = <span style="color: #a020f0;">new</span> <span style="color: #228b22;">Random</span><span style="color: #707183;">()</span>;

<span style="color: #228b22;">string</span> <span style="color: #a0522d;">a</span> = <span style="color: #8b2252;">"oO0iL1lI"</span>;

<span style="color: #228b22;">StringBuilder</span> <span style="color: #a0522d;">sb</span> = <span style="color: #a020f0;">new</span> <span style="color: #228b22;">StringBuilder</span><span style="color: #707183;">()</span>;
<span style="color: #a020f0;">for</span> <span style="color: #707183;">(</span><span style="color: #228b22;">int</span> <span style="color: #a0522d;">i</span> = 0; i &lt; 5; i++<span style="color: #707183;">)</span>
<span style="color: #707183;">{</span>
    sb.<span style="color: #0000ff;">Append</span><span style="color: #7388d6;">(</span>a<span style="color: #909183;">[</span>r.<span style="color: #0000ff;">Next</span><span style="color: #709870;">(</span>a.Length - 1<span style="color: #709870;">)</span><span style="color: #909183;">]</span><span style="color: #7388d6;">)</span>;
<span style="color: #707183;">}</span>

Console.<span style="color: #0000ff;">WriteLine</span><span style="color: #707183;">(</span>sb.<span style="color: #0000ff;">ToString</span><span style="color: #7388d6;">()</span><span style="color: #707183;">)</span>;
</pre>
</div>
</div>
</div>

<div id="outline-container-org934289b" class="outline-4">
<h4 id="org934289b"><span class="section-number-4">1.2.4.</span> 消除字符串的基本逻辑</h4>
<div class="outline-text-4" id="text-1-2-4">
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #a020f0;">public</span> <span style="color: #228b22;">void</span> <span style="color: #0000ff;">xiaochu</span><span style="color: #707183;">()</span>
<span style="color: #707183;">{</span>
    Console.<span style="color: #0000ff;">Clear</span><span style="color: #7388d6;">()</span>;
    Console.<span style="color: #0000ff;">WriteLine</span><span style="color: #7388d6;">(</span>x<span style="color: #7388d6;">)</span>;
    <span style="color: #a020f0;">for</span> <span style="color: #7388d6;">(</span><span style="color: #228b22;">int</span> <span style="color: #a0522d;">i</span> = 0; i &lt; x.Length - 2; i++<span style="color: #7388d6;">)</span>
    <span style="color: #7388d6;">{</span>
        <span style="color: #a020f0;">if</span> <span style="color: #909183;">(</span>x<span style="color: #709870;">[</span>i<span style="color: #709870;">]</span> == x<span style="color: #709870;">[</span>i + 1<span style="color: #709870;">]</span> &amp;&amp; x<span style="color: #709870;">[</span>i<span style="color: #709870;">]</span> == x<span style="color: #709870;">[</span>i + 2<span style="color: #709870;">]</span><span style="color: #909183;">)</span>
        <span style="color: #909183;">{</span>
            Console.ForegroundColor = ConsoleColor.Magenta;
            Console.<span style="color: #0000ff;">SetCursorPosition</span><span style="color: #709870;">(</span>i, 0<span style="color: #709870;">)</span>;
            Console.<span style="color: #0000ff;">Write</span><span style="color: #709870;">(</span>x.<span style="color: #0000ff;">ToString</span><span style="color: #907373;">()</span>.<span style="color: #0000ff;">Substring</span><span style="color: #907373;">(</span>i, 3<span style="color: #907373;">)</span><span style="color: #709870;">)</span>;
            Console.<span style="color: #0000ff;">ResetColor</span><span style="color: #709870;">()</span>;

            Thread.<span style="color: #0000ff;">Sleep</span><span style="color: #709870;">(</span>800<span style="color: #709870;">)</span>;
            Console.<span style="color: #0000ff;">SetCursorPosition</span><span style="color: #709870;">(</span>i, 0<span style="color: #709870;">)</span>;
            Console.<span style="color: #0000ff;">Write</span><span style="color: #709870;">(</span><span style="color: #8b2252;">"   "</span><span style="color: #709870;">)</span>;
            x.<span style="color: #0000ff;">Remove</span><span style="color: #709870;">(</span>i, 3<span style="color: #709870;">)</span>;

            Thread.<span style="color: #0000ff;">Sleep</span><span style="color: #709870;">(</span>200<span style="color: #709870;">)</span>;
            <span style="color: #0000ff;">xiaochu</span><span style="color: #709870;">()</span>;
        <span style="color: #909183;">}</span>
    <span style="color: #7388d6;">}</span>
<span style="color: #707183;">}</span>
</pre>
</div>
</div>
</div>
</div>
</section>
</div>
<div id="postamble" class="status">
<p class="author">Author: 悟饭</p>
<p class="date">Created: 2021-05-31</p>
<p class="validation">Go ahead, never stop.</p>
</div>
</body>
</html>
